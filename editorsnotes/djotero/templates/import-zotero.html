{% extends "base.html" %}

{% block js %}
    <script type="text/javascript; e4x=1" src="/media/function/citeproc-js/xmle4x.js"></script> 
    <script type="text/javascript" src="/media/function/citeproc-js/xmldom.js"></script>
    <script type="text/javascript" src="/media/function/citeproc-js/citeproc.js"></script>
    <script type="text/javascript" src="/media/function/citeproc-js/simple.js"></script>
    <script type="text/javascript" src="/media/function/json2.js"></script>
    <script type="text/javascript" src="/media/function/zotero-import.js"></script>
    <script type="text/javascript">
    {% if related_object %}
      var related_object = '{{ related_object }}';
      var related_id = '{{ related_id }}';
    {% else %}
      var related_object = ''
      var related_id = ''
    {% endif %}
      var zoteroLibrary = 'https://api.zotero.org/users/{{ zotero_uid }}'
    </script>
{% endblock %}

{% block css %}
<style type="text/css">
#collections li {
    padding: .33em;
    font-size: 90%;
    border-bottom: 1px dotted #CCCCCC;
}

#collections *:hover {
    background-color: #336699;
    color: #FFFFFF;
}

.collection-selected {
    background-color: #336699;
    color: #FFFFFF;
}

td {
    border-bottom: 1px dotted #CCCCCC;
}
th, td {
    padding: 4px;
    text-align: left;
    vertical-align: top;
    font-size: 90%;
}
thead th {background:#D7DEDF;}

</style>
{% endblock %}

{% block content %}

{% if zotero_status %}

<div id="query" class="span-6 colborder">
  <ul id="collections">
    <li id="collection-0" class="collection-item" location="https://api.zotero.org/users/{{ zotero_uid }}"><h3>Your Zotero library</h3></li>
  </ul>
</div>

<div id="items" class="span-17 last">
  <div id="items-table" style="display: none">
    <div id="items-browsing" style="height: 42px;" class="span-16 last">
      <span id="items-browsing-count" style="height: 42px; margin-top: 7px;" class="span-8">
      </span>
      <span id="items-browsing-search" style="height: 42px;" class="span-8 last">
        <a class="button" style="float:right; margin-left: 5px; margin-top: 3px;" id="zotero-search-submit">Search</a>
        <input id="zotero-search" style="float:right" type="text">
      </span>
    </div>
    <table class="span-16 last">{% csrf_token %}
      <thead>
        <tr>
          <th class="item-checkbox"><input type="checkbox"></th>
          <th>Title</th>
          <th>Creator</th>
          <th>Date</th>
          <th>Item type</th>
        </tr>
      </thead>
      <tbody id="item-list">
      </tbody>
    </table>
    <div>
      <a id="post-items" class="button">Import selected items</a>
    </div>
  </div>
  <img class="loader" src="/media/style/icons/ajax-loader.gif" style="display: none">
</div>

<div id="success" style="display: none;">
    <a class="button" href="{{ return_to }}">Return to previous page</a>
    <hr style="background: white;"/>
    <ul id="imported">
        <h6>Items imported</h6>
    </ul>
    <ul id="not-imported">
    </ul>
    <ul id="errors">
    </ul>
</div>

{% else %}
    <p>You have not yet entered Zotero access information. Click on your name in the top navigation bar to do so.</p>
{% endif %}
{% endblock %}
