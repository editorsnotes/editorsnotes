{% extends "base.html" %}

{% block js %}
    <script type="text/javascript; e4x=1" src="/media/function/citeproc-js/xmle4x.js"></script> 
    <script type="text/javascript" src="/media/function/citeproc-js/xmldom.js"></script>
    <script type="text/javascript" src="/media/function/citeproc-js/citeproc.js"></script>
    <script type="text/javascript" src="/media/function/citeproc-js/simple.js"></script>
    <script type="text/javascript" src="/media/function/json2.js"></script>
    <script type="text/javascript" src="/media/function/zotero-import.js"></script>
    <script type="text/javascript">
    {% if related_object %}
      var related_object = '{{ related_object }}';
      var related_id = '{{ related_id }}';
    {% else %}
      var related_object = ''
      var related_id = ''
    {% endif %}
    </script>
{% endblock %}

{% block css %}
<style type="text/css">
.top-label h6 {padding-bottom: .75em;}
#collections {height: 20em;}
.zotero-link {padding: .25em;}
.zotero-link a {text-decoration: none;}
.add-to-document a {text-decoration: none;}
.zotero-link input {margin-right: .5em; margin-left: .25em;}
#document {padding-bottom: 1em;}
.zotero-link img { {% if not apply_to_docs %}display: none; {% endif %}vertical-align: middle; }
.djotero-list li {
    border: 1px none;
    border-radius: 5px 5px 5px 5px;
    margin: 0.2em;
    padding: 0.4em;
}
.djotero-list li.item-hover {
    background: none repeat scroll 0 0 #F0F0F0;
}
.djotero-list li.item-selected {
    background: #D7DEDF;
}

.items-options-label {
    font-size: 13px;
    float: left;
    height: 19px;
    margin: 8px 0 8px 8px;
    width: 90px;
}
td {
    border-bottom: 1px dotted #CCCCCC;
}
th, td {
    padding: 4px;
    text-align: left;
    vertical-align: top;
    font-size: 90%;
}
thead th {background:#D7DEDF;}

</style>
{% endblock %}

{% block content %}

{% if zotero_status %}
<div id="access" class="span-24 last">
  <section id="libraries" class="span-6">
    <span class="top-label">
      <h6>Select a library to import from</h6>
    </span>
    <a class="button" href="#" id="get-libraries">Determine access</a>
    <ul id="library-list" class="djotero-list active">
    </ul>
  </section>
  
  <section id="collections" style="display: none;" class="span-9 colborder after-library">
    <span class="top-label">
      <h6>Optional: Select a collection from the library</h6>
    </span>
    <a class="button" href="#" id="get-collections">Determine collections</a>
    <ul id="collection-list" class="djotero-list active">
    </ul>
  </section>
  
  <section id="query" style="display: none;" class="span-8 last after-library">
    <span class="top-label">
      <h6>&nbsp;</h6>
    </span>
    <div id="get-items">
        <a class="button" href="#">Get items</a>
    </div>
    <br/>
    <div id="items-options" style="margin-top:2em; border: 1px solid #CCC;">
        <span key="order">
            <label class="items-options-label">Sorted by</label>
            <select class="items-option">
                <option value="dateModified">Date modified</option>
                <option value="dateAdded">Date added</option>
                <option value="title">Title</option>
                <option value="type">Item type</option>
                <option value="date">Date</option>
                <option value="publication">Publication</option>
                <option value="language">Language</option>
            </select>
        </span>
        <span key="limit" style="display: block">
            <label class="items-options-label">Max. results</label>
             <select class="items-option">
                <option value="10">10</option>
                <option value="20">20</option>
                <option value="30">30</option>
                <option value="40">40</option>
                <option value="50">50</option>
            </select>
        </span>
        <span key="q">
            <label class="items-options-label">Search string</label>
            <input type="text" class="items-option" name="items-option-search-string-value"/>
        </span>
    </div>
  </section>
</div>

<div id="items" class="span-24 last" style="display: none">
  <table>{% csrf_token %}
    <thead>
      <tr>
        <th class="item-checkbox"><input type="checkbox"></th>
        <th>Title</th>
        <th>Creator</th>
        <th>Date</th>
        <th>Item type</th>
      </tr>
    </thead>
    <tbody id="item-list">
    </tbody>
  </table>
  <div>
    <a id="post-items" class="button">Import selected items</a>
  </div>  
</div>
<div id="success">
    <div id="imported">
    </div>
    <div id="not-imported">
    </div>
    <div id="errors">
    </div>
</div>
<div id="doc-add-form">
  <div id="document"></div>
  <div id="docsearch">
    <span>Search for item:<span>
    <input type="text" class="text" name="q"/>
    <a class="button" style="display: none;" id="link-document">Submit</a>
  </div>
</div>

{% else %}
    <p>You have not yet entered Zotero access information. Click on your name in the top navigation bar to do so.</p>
{% endif %}
{% endblock %}
